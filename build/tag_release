#!/usr/bin/env bash

set -e
set -x

NODE_PACKAGE_VERSION=$(cat package.json | jq -r .version)

: "${GIT_TAG:="$NODE_PACKAGE_VERSION"}
: "${RELEASE_BRANCH:=release}

if [ -z "$GIT_REPO_REMOTE" ]; then
    echo "GIT_REPO_REMOTE is required";
    exit 1
fi

git remote add release_repo "$GIT_REPO_REMOTE"
git tag -a "$NODE_PACKAGE_VERSION" -m "$NODE_PACKAGE_VERSION"
git push release_repo "$NODE_PACKAGE_VERSION"
